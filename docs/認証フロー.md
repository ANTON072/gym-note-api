# アプリケーションの認証フロー

1. フロントエンド: Firebase Auth で Google ログイン実行
2. フロントエンド: Firebase ID トークンを取得
3. フロントエンド: 全 API リクエストの Authorization ヘッダーに ID トークンを付与
4. Rails API: Firebase Admin SDK でトークンを検証
5. Rails API: ユーザーが存在しなければ自動作成（firebase_uid, email 等を保存）
6. Rails API: 処理を実行してレスポンスを返す

※ トークン期限切れ（401 エラー）時の処理：

- フロントエンドが Firebase でトークンを再取得
- フロントエンドが API リクエストをリトライ

## Firebase 設定

Firebase Authentication の設定：

- Google プロバイダを有効化
- Firebase プロジェクトの公開鍵を使用してトークン検証

必要な Gem：

- jwt（Firebase ID トークンの手動検証用）

## Todo

### 1. JWT 手動検証アプローチを採用 ✅

- jwt gem を使用して Firebase ID トークンを検証 ✅
- Firebase 公開鍵を取得してトークン署名を検証 ✅

### 2. User モデル作成 ✅

- firebase_uid, email, name, image_url fields ✅
- firebase_uid でユーザー識別 ✅

### 3. 認証ミドルウェア実装

- Authorization ヘッダーからトークン取得
- JWT でトークン検証・ユーザー情報抽出
- ユーザー未存在時は自動作成

### 4. ApplicationController に認証機能追加

- current_user メソッド
- authenticate_user! メソッド
